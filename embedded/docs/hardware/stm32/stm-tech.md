## STM32 术语手册

<br>

### 其余不易分类术语

`使能` 通过设置寄存器或者管脚的状态来使某个模块或者外设开始工作  
`失能` 通过设置寄存器或者管脚的状态来停止某个模块或者外设的工作

<br>

`上拉电阻` 将输入端口连接到电源电压的电阻，上拉情况下，当没有外部信号输入时，输入端口将保持高电平状态  
`下拉电阻` 将输入端口连接到地的电阻，下拉情况下，当没有外部信号输入时，输入端口将保持低电平状态

<br>

### 定时器

`RCC 时钟控制模块（Reset and Clock Control）`

- 控制系统的时钟和复位功能
- 对系统时钟进行各种配置和管理
- 负责控制系统的复位功能

<br>

`TIM 定时器/计数器（Timer/Counter）`

- 可设置多个通道，如定时器模式、输入捕获模式、输出比较模式或 PWM 输出模式
- 可以由内部时钟源或外部时钟源驱动，还可以通过预分频器和自动重载寄存器（ARR）来实现更灵活的计时控制

<br>

`PSC 定时器/计数器的预分频器寄存器（Prescaler Register）`

- 设置定时器/计数器的时钟预分频系数，以改变计时器时钟的频率
- 用于改变计数器的计数速度
- 将定时器/计数器时钟源的频率除以预分频系数，从而得到更低的计数速度

<br>

`CNT 定时器/计数器的计数器寄存器（Counter Register）`

- 用于储存定时器/计数器的计数值
- 可以在达到指定计数值时触发相应的事件或中断
- PWM 控制中，可以通过读取定时器/计数器的计数器寄存器来判断何时应该改变 PWM 输出的电平状态

<br>

`影子寄存器`  
通常存在于定时器与 DMA 中，即同一寄存器划分为主次两个寄存器，主寄存器可被程序员操作，而次寄存器则不可见；  
次寄存器即为影子寄存器，常用于保存上一步执行的数据；

<br>

`时钟使能`

- 指通过设置相关的寄存器来启用或关闭特定的外设或功能模块所需的时钟信号；
- STM32 外设众多，故基本上每一个外设都被分配一个专属时钟使能
- 时钟系统由多个时钟源、时钟树和分频器组成，可以生成多个时钟信号，为不同的外设和模块提供时钟信号

<br>

`分频系数`

- 它是用于控制时钟频率的一种参数
- 分频系数越大，分频后的时钟频率越低，定时或计数的时间就越长

<br>

`ARR（Auto-reload register）自动重装值寄存器`

- 它用于设定计数器计数的上限值，当计数器计数达到自动重装值时，计数器会重新从 0 开始计数
- 在定时器应用中，自动重装值决定了定时器的定时周期
- 在计数器应用中，自动重装值决定了计数器的计数上限

<br>

`计数方式`

- 向上计数模式（Up-counting Mode）：计数器从 0 开始，每计数一次计数值加 1，当计数值达到自动重装值时，计数器重新从 0 开始计数。
- 向下计数模式（Down-counting Mode）：计数器从自动重装值开始，每计数一次计数值减 1，当计数值减到 0 时，计数器重新从自动重装值开始计数。
- 向上/向下计数模式（Up/Down-counting Mode）：计数器从自动重装值开始向上计数，当计数值达到自动重装值时，计数器开始向下计数，当计数值减到 0 时，计数器重新从自动重装值开始向上计数。

<br>

<br>

### 看门狗

<br>

### 中断

`NVIC（Nested Vectored Interrupt Controller）`

- 负责管理所有外部和内部中断请求，并且支持多级中断嵌套
- 可以优先级和向量号（即中断服务函数的地址）来区分和处理不同的中断请求
- 可以实现多任务处理、实时控制和事件驱动等功能

<br>

`ISR 中断服务程序（Interrupt Service Routine）`

- 指在中断发生时被调用的一段代码
- 当中断事件发生时，CPU 会暂停当前任务的执行，进入中断服务程序执行相应的处理
- 在执行中断服务程序时，CPU 会自动保存当前任务的上下文
- 中断服务程序通常需要先在向量表中注册，以便在中断发生时能够被正确地调用

<br>

### PWM 脉冲宽度调制

`CCR 捕获比较寄存器（Capture/Compare Register，CCR）`

- 在捕获模式下，CCR 用于捕获外部信号的时间戳
- 在比较模式下，CCR 用于比较计数器的值，从而实现 PWM 输出等功能

<br>

`刹车死区寄存器`  
用于控制电机驱动器中刹车死区时间的寄存器

`DTG（Dead-Time Generator）`

- 配置刹车死区时间的寄存器，用于防止功率半导体器件（如 MOSFET 或 IGBT）在切换时出现短路故障
- 可以配置用于产生刹车死区的时间间隔

<br>

`滤波器`

- 用于对模拟信号进行滤波处理，以去除噪声、滤波干扰、改善信号质量
- 硬件滤波器是由一组 RC 电路组成的低通滤波器，主要用于抑制高频噪声和滤波干扰，保证输入信号的稳定性和精确性
- 软件滤波器是由 CPU 实现的滤波器，主要用于实现滤波器的高级功能，如带通滤波、带阻滤波、滑动平均滤波

<br>

### 存储器

#### FSMC

> 外部存储器接口（Flexible Static Memory Controller）

- STM32 微控制器系列中用于连接外部存储器（如 SRAM、NAND Flash、NOR Flash 等）的接口
- 支持异步、同步和多通道数据传输模式

FSMC 将外部设备分为 2 类：`NOR/PSRAM` 设备、
`NAND/PC` 卡设备

FSMC 将外部存储器划分为固定大小为 256M 字节的四个存储块（Bank），统共管理 1GB 空间

`存储块 1（Bank1）` 被分为 4 个区，每个区管理 64M 字节空间，每个区都有独立的寄存器对所连接的存储器进行配置

<br>

#### RNG

> RNG（Random Number Generator）随机数生成器

随机数生成器的输入来自于两个独立的噪声源：硬件噪声和内部温度传感器。这些噪声源被放大、采样并处理成一个随机数字

使用步骤：先启动时钟，并配置相应的中断或轮询模式，然后读取 `RNG_DR` 寄存器中的数据  
（读取 `RNG_DR` 寄存器前，应该先检查 SR 寄存器中的 DRDY 标志位，以确保数据可用）

`RNG_LFSR 线性反馈移位寄存器`  
由专用时钟提供时钟信息，即种子，之后 RNG_LFSR 会把种子传递给 RNG_DR

`RNG_SR` 用于检测当专用时钟制作的种子出现异常或者时钟频率不对时，会自动读取对应列，且可人为设置对应中断

<br>

### 总线与时钟

#### RTC 时钟

> STM32F4 的 RTC，是一个独立的 BCD 定时器/计数器。并且提供日历功能
